axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplP_tempP.pdf"), plot = last_plot(), height = 6, width = 9, units = "in")
# Graphs the relationship between EPL (gap) and temporary employment
df_graph <- df_merge_diff
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl_gap, color = "EPL gap")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL gap",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplG_tempP.pdf"), plot = last_plot(), height = 6, width = 9, units = "in")
df_temp_1 <- df_temp_0 %>%
filter(sex == "MW", # men and women
series == "PER_CENT_TEMP", # percent temporary
age == "1524", # young workers
) %>%
select(-series) %>%
rename(year=obstime,
temp=obsvalue) %>%
mutate(year = as.numeric(year)) %>%
filter(year>=1990)
# Merge data ----
df_merge <- merge(df_epl, df_temp_1, by = c("country","year"), all.x = TRUE)
df_merge$country_name <- countrycode(df_merge$country, 'genc3c', 'country.name')
df_merge <- merge(df_merge,geography,all.y = TRUE)
df_merge <- df_merge %>%
arrange(country,series,year)
df_merge_diff <- merge(df_epl_diff, df_temp_1, by = c("country","year"), all.x = TRUE)
df_merge_diff$country_name <- countrycode(df_merge_diff$country, 'genc3c', 'country.name')
df_merge_diff <- merge(df_merge_diff,geography,all.y = TRUE)
df_merge_diff <- df_merge_diff %>%
arrange(country,year)
# Clean data ----
df_merge <- df_merge %>%
filter(!is.na(temp)) %>% # countries must have temporary employment rate
group_by(country,series) %>%
mutate(sum = row_number(),
sum = last(sum)) %>%
mutate(cor = round(cor(epl,temp),3)) %>% # estimate correlation
ungroup() %>%
filter(sum>2) %>% # countries must have at least 3 observations
select(-sum)
df_merge <- droplevels(df_merge)
df_merge_diff <- df_merge_diff %>%
filter(!is.na(temp)) %>% # countries must have temporary employment rate
group_by(country) %>%
mutate(sum = row_number(),
sum = last(sum)) %>%
mutate(cor = round(cor(epl_gap,temp),3)) %>% # estimate correlation
ungroup() %>%
filter(sum>2) %>% # countries must have at least 3 observations
select(-sum)
df_merge_diff <- droplevels(df_merge_diff)
# Graph ----
# Graphs the relationship between EPL (temp) and temporary employment
df_graph <- df_merge %>%
filter(series == "temp_epl")
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl, color = "EPL")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL (Temporary employment)",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 3,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplT_tempY.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
# Graphs the relationship between EPL (perm) and temporary employment
df_graph <- df_merge %>%
filter(series == "perm_epl")
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl, color = "EPL")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL (Permanent employment)",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 3,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplP_tempY.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
# Graphs the relationship between EPL (gap) and temporary employment
df_graph <- df_merge_diff
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl_gap, color = "EPL gap")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL gap",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 3,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplG_tempY.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
# Graphs the relationship between EPL (temp) and temporary employment
df_graph <- df_merge %>%
filter(series == "temp_epl")
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl, color = "EPL")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL (Temporary employment)",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 2,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplT_tempY.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
# Graphs the relationship between EPL (perm) and temporary employment
df_graph <- df_merge %>%
filter(series == "perm_epl")
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl, color = "EPL")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL (Permanent employment)",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 2,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplP_tempY.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
# Graphs the relationship between EPL (gap) and temporary employment
df_graph <- df_merge_diff
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl_gap, color = "EPL gap")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL gap",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 2,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplG_tempY.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
# Graphs the relationship between EPL (temp) and temporary employment
df_graph <- df_merge %>%
filter(series == "temp_epl")
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl, color = "EPL")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL (Temporary employment)",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 3,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplT_tempY.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
# Graphs the relationship between EPL (perm) and temporary employment
df_graph <- df_merge %>%
filter(series == "perm_epl")
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl, color = "EPL")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL (Permanent employment)",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 3,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplP_tempY.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
# Graphs the relationship between EPL (gap) and temporary employment
df_graph <- df_merge_diff
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl_gap, color = "EPL gap")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL gap",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 3,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplG_tempY.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
df_temp_1 <- df_temp_0 %>%
filter(sex == "MW", # men and women
series == "PER_CENT_TEMP", # percent temporary
age == "2554", # prime age workers
) %>%
select(-series) %>%
rename(year=obstime,
temp=obsvalue) %>%
mutate(year = as.numeric(year)) %>%
filter(year>=1990)
# Merge data ----
df_merge <- merge(df_epl, df_temp_1, by = c("country","year"), all.x = TRUE)
df_merge$country_name <- countrycode(df_merge$country, 'genc3c', 'country.name')
df_merge <- merge(df_merge,geography,all.y = TRUE)
df_merge <- df_merge %>%
arrange(country,series,year)
df_merge_diff <- merge(df_epl_diff, df_temp_1, by = c("country","year"), all.x = TRUE)
df_merge_diff$country_name <- countrycode(df_merge_diff$country, 'genc3c', 'country.name')
df_merge_diff <- merge(df_merge_diff,geography,all.y = TRUE)
df_merge_diff <- df_merge_diff %>%
arrange(country,year)
# Clean data ----
df_merge <- df_merge %>%
filter(!is.na(temp)) %>% # countries must have temporary employment rate
group_by(country,series) %>%
mutate(sum = row_number(),
sum = last(sum)) %>%
mutate(cor = round(cor(epl,temp),3)) %>% # estimate correlation
ungroup() %>%
filter(sum>2) %>% # countries must have at least 3 observations
select(-sum)
df_merge <- droplevels(df_merge)
df_merge_diff <- df_merge_diff %>%
filter(!is.na(temp)) %>% # countries must have temporary employment rate
group_by(country) %>%
mutate(sum = row_number(),
sum = last(sum)) %>%
mutate(cor = round(cor(epl_gap,temp),3)) %>% # estimate correlation
ungroup() %>%
filter(sum>2) %>% # countries must have at least 3 observations
select(-sum)
df_merge_diff <- droplevels(df_merge_diff)
# Graph ----
# Graphs the relationship between EPL (temp) and temporary employment
df_graph <- df_merge %>%
filter(series == "temp_epl")
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl, color = "EPL")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL (Temporary employment)",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 3,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplT_tempP.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
# Graphs the relationship between EPL (perm) and temporary employment
df_graph <- df_merge %>%
filter(series == "perm_epl")
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl, color = "EPL")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL (Permanent employment)",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 3,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplP_tempP.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
# Graphs the relationship between EPL (gap) and temporary employment
df_graph <- df_merge_diff
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl_gap, color = "EPL gap")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL gap",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 3,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplG_tempP.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
df_temp_1 <- df_temp_0 %>%
filter(sex == "MW", # men and women
series == "PER_CENT_TEMP", # percent temporary
age == "900000", # all workers
) %>%
select(-series) %>%
rename(year=obstime,
temp=obsvalue) %>%
mutate(year = as.numeric(year)) %>%
filter(year>=1990)
# Merge data ----
df_merge <- merge(df_epl, df_temp_1, by = c("country","year"), all.x = TRUE)
df_merge$country_name <- countrycode(df_merge$country, 'genc3c', 'country.name')
df_merge <- merge(df_merge,geography,all.y = TRUE)
df_merge <- df_merge %>%
arrange(country,series,year)
df_merge_diff <- merge(df_epl_diff, df_temp_1, by = c("country","year"), all.x = TRUE)
df_merge_diff$country_name <- countrycode(df_merge_diff$country, 'genc3c', 'country.name')
df_merge_diff <- merge(df_merge_diff,geography,all.y = TRUE)
df_merge_diff <- df_merge_diff %>%
arrange(country,year)
# Clean data ----
df_merge <- df_merge %>%
filter(!is.na(temp)) %>% # countries must have temporary employment rate
group_by(country,series) %>%
mutate(sum = row_number(),
sum = last(sum)) %>%
mutate(cor = round(cor(epl,temp),3)) %>% # estimate correlation
ungroup() %>%
filter(sum>2) %>% # countries must have at least 3 observations
select(-sum)
df_merge <- droplevels(df_merge)
df_merge_diff <- df_merge_diff %>%
filter(!is.na(temp)) %>% # countries must have temporary employment rate
group_by(country) %>%
mutate(sum = row_number(),
sum = last(sum)) %>%
mutate(cor = round(cor(epl_gap,temp),3)) %>% # estimate correlation
ungroup() %>%
filter(sum>2) %>% # countries must have at least 3 observations
select(-sum)
df_merge_diff <- droplevels(df_merge_diff)
# Graph ----
# Graphs the relationship between EPL (temp) and temporary employment
df_graph <- df_merge %>%
filter(series == "temp_epl")
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl, color = "EPL")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL (Temporary employment)",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 3,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplT_tempA.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
# Graphs the relationship between EPL (perm) and temporary employment
df_graph <- df_merge %>%
filter(series == "perm_epl")
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl, color = "EPL")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL (Permanent employment)",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 3,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplP_tempA.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
df_graph <- df_merge_diff
# Graphs the relationship between EPL (gap) and temporary employment
ggplot(data = df_graph, aes(x = year)) +
facet_wrap(~region+country_name,scales = "free_y") +
geom_line(aes(y=epl_gap, color = "EPL gap")) +
geom_line(aes(y=temp/10, color = "Temp emp")) +
theme_bw() +
scale_color_manual(values = c("blue", "orange")) +
scale_y_continuous(
name = "EPL gap",
sec.axis = sec_axis(~./10, name="Temporary employment (%)")
) +
geom_text(aes(label=paste("r = ", cor)),
size = 3,
x=-Inf, y=Inf, hjust=-0.2, vjust=1.2)+
theme(panel.grid.minor = element_blank(),
axis.line.y = element_line(color="black", size=.5),
axis.line.x = element_line(color="black", size=.5),
legend.title=element_blank(),
legend.key.width = unit(2,"cm"),
legend.position = "bottom"
)
ggsave(filename = paste0(graphs,"graph_eplG_tempA.pdf"), plot = last_plot(), height = 8, width = 12, units = "in")
